<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Dashboard Â· Gor://a Builder</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1594181130407895" crossorigin="anonymous"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>

  <style>
    /* --- FONTS --- */
    @font-face {
      font-family: 'din-next-w01-light';
      font-style: normal;
      font-weight: 400;
      src: url('//static.parastorage.com/fonts/v2/eca8b0cd-45d8-43cf-aee7-ca462bc5497c/v1/din-next-w02-light.woff2') format('woff2');
      font-display: swap;
    }

    /* --- VARIABLES --- */
    :root {
      --bg: #050505;
      --sidebar-bg: rgba(10, 10, 12, 0.6);
      --panel-bg: rgba(20, 20, 25, 0.4);
      --border: rgba(255, 255, 255, 0.08);
      --border-hover: rgba(255, 255, 255, 0.15);
      --accent: #3b6cff;
      --accent-glow: rgba(59, 108, 255, 0.25);
      --text: #ffffff;
      --text-muted: #8a8a93;
      --noise: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.04'/%3E%3C/svg%3E");
      --ease-out: cubic-bezier(0.16, 1, 0.3, 1);
    }

    body.premium {
      --accent: #ffd700; 
      --accent-glow: rgba(255, 215, 0, 0.2);
    }

    * { box-sizing: border-box; font-family: 'din-next-w01-light', system-ui, sans-serif; outline: none; }

    body {
      margin: 0; background: var(--bg); color: var(--text);
      height: 100vh; display: flex; overflow: hidden;
    }

    /* --- BACKGROUND EFFECTS --- */
    .noise-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background-image: var(--noise); pointer-events: none; z-index: 0;
    }

    .glow-spot {
      position: fixed; width: 600px; height: 600px;
      background: radial-gradient(circle, var(--accent-glow) 0%, transparent 70%);
      opacity: 0.4; pointer-events: none; z-index: 0;
      top: -200px; left: 20%; filter: blur(80px);
    }

    /* --- SIDEBAR --- */
    aside {
      width: 260px; background: var(--sidebar-bg); backdrop-filter: blur(20px);
      border-right: 1px solid var(--border); display: flex; flex-direction: column;
      padding: 24px 16px; z-index: 10; position: relative;
    }

    .logo {
      font-size: 22px; font-weight: 600; color: #fff;
      display: flex; align-items: center; gap: 12px; margin-bottom: 40px;
      padding-left: 12px; letter-spacing: -0.5px;
    }
    .logo svg { color: var(--accent); width: 24px; height: 24px; }

    .premium-badge {
      font-size: 10px; background: var(--accent); color: #000;
      padding: 2px 6px; border-radius: 4px; font-weight: 800; letter-spacing: 0.5px;
      display: none; transform: translateY(-1px);
    }
    body.premium .premium-badge { display: inline-block; }

    nav { display: flex; flex-direction: column; gap: 4px; flex: 1; }
    
    nav a {
      color: var(--text-muted); text-decoration: none; padding: 10px 12px;
      border-radius: 10px; font-size: 14px; transition: all 0.2s var(--ease-out);
      display: flex; align-items: center; gap: 12px; position: relative; overflow: hidden;
    }
    nav a:hover { background: rgba(255,255,255,0.05); color: #fff; }
    nav a.active { background: rgba(255,255,255,0.08); color: #fff; font-weight: 500; }
    nav a i { font-size: 18px; opacity: 0.7; }
    nav a:hover i, nav a.active i { opacity: 1; color: var(--accent); }

    /* --- USER PROFILE --- */
    .profile-container { margin-top: auto; position: relative; padding-top: 16px; border-top: 1px solid var(--border); }

    .user-profile {
      display: flex; align-items: center; gap: 12px; padding: 10px;
      border-radius: 12px; cursor: pointer; transition: background 0.2s;
    }
    .user-profile:hover { background: rgba(255,255,255,0.05); }

    .avatar {
      width: 36px; height: 36px; background: linear-gradient(135deg, #2a2a30, #151518);
      border: 1px solid var(--border); border-radius: 50%;
      display: flex; align-items: center; justify-content: center;
      font-size: 14px; font-weight: 600; color: #fff; position: relative;
    }
    .avatar::after {
      content: ''; position: absolute; bottom: 0; right: 0;
      width: 10px; height: 10px; background: #10b981;
      border: 2px solid var(--bg); border-radius: 50%;
    }

    .user-info { display: flex; flex-direction: column; font-size: 13px; line-height: 1.3; }
    .user-name { color: #fff; font-weight: 500; }
    .user-plan { color: var(--text-muted); font-size: 11px; text-transform: capitalize; }

    .profile-menu {
      position: absolute; bottom: 100%; left: 0; width: 100%;
      background: #1a1a1f; border: 1px solid var(--border); border-radius: 12px;
      padding: 6px; display: flex; flex-direction: column; gap: 2px;
      opacity: 0; pointer-events: none; transform: translateY(10px);
      transition: all 0.2s var(--ease-out); box-shadow: 0 10px 40px rgba(0,0,0,0.5);
      z-index: 20; margin-bottom: 8px;
    }
    .profile-container:hover .profile-menu { opacity: 1; pointer-events: auto; transform: translateY(0); }

    .menu-item {
      padding: 8px 12px; font-size: 13px; color: var(--text-muted);
      text-decoration: none; border-radius: 8px; display: flex; align-items: center; gap: 8px;
      transition: all 0.15s;
    }
    .menu-item:hover { background: rgba(255,255,255,0.08); color: #fff; }
    .menu-item.logout { color: #ff5c5c; }
    .menu-item.logout:hover { background: rgba(255, 92, 92, 0.1); }

    /* --- MAIN CONTENT --- */
    main { flex: 1; overflow-y: auto; padding: 40px 60px; position: relative; z-index: 1; }
    main::-webkit-scrollbar { width: 6px; }
    main::-webkit-scrollbar-track { background: transparent; }
    main::-webkit-scrollbar-thumb { background: #333; border-radius: 3px; }

    @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    .animate-entry { animation: slideUp 0.6s var(--ease-out) forwards; opacity: 0; }

    /* HEADER */
    .header-row { display: flex; justify-content: space-between; align-items: flex-end; margin-bottom: 60px; }
    .greeting h1 { font-size: 38px; font-weight: 300; margin: 0 0 4px; letter-spacing: -0.5px; }
    .greeting p { color: var(--text-muted); margin: 0; font-size: 15px; }

    .token-widget {
      display: flex; align-items: center; gap: 12px; padding: 8px 16px 8px 8px;
      background: rgba(255,255,255,0.03); border: 1px solid var(--border);
      border-radius: 99px; backdrop-filter: blur(10px);
    }
    .token-icon {
      width: 32px; height: 32px; background: rgba(255,255,255,0.05); border-radius: 50%;
      display: flex; align-items: center; justify-content: center; color: var(--accent);
    }
    .token-text { display: flex; flex-direction: column; line-height: 1.1; }
    .token-val { font-size: 14px; font-weight: 600; color: #fff; }
    .token-lbl { font-size: 11px; color: var(--text-muted); }

    .upgrade-btn {
      background: #fff; color: #000; padding: 10px 20px; border-radius: 99px;
      font-size: 13px; font-weight: 600; text-decoration: none;
      transition: transform 0.2s; box-shadow: 0 0 20px rgba(255,255,255,0.2);
    }
    .upgrade-btn:hover { transform: scale(1.05); }

    /* --- BUILDER --- */
    .builder-section { max-width: 800px; margin: 0 auto 80px auto; text-align: center; }

    .input-box {
      position: relative; background: rgba(15, 15, 20, 0.6);
      border: 1px solid var(--border); border-radius: 20px; padding: 8px;
      display: flex; align-items: center; gap: 12px;
      box-shadow: 0 10px 40px -10px rgba(0,0,0,0.5); backdrop-filter: blur(24px);
      transition: all 0.3s var(--ease-out);
    }
    .input-box:focus-within {
      border-color: rgba(255,255,255,0.2);
      box-shadow: 0 20px 60px -10px rgba(0,0,0,0.7), 0 0 0 1px var(--accent);
      transform: translateY(-2px) scale(1.01);
    }
    .input-box.disabled { opacity: 0.6; pointer-events: none; border-color: rgba(255,50,50,0.3); }

    .input-box input[type="text"] {
      flex: 1; background: transparent; border: none; color: #fff;
      font-size: 17px; height: 52px; padding-left: 16px; font-weight: 400;
    }
    .input-box input::placeholder { color: rgba(255,255,255,0.25); transition: opacity 0.2s; }
    .input-box:focus-within input::placeholder { opacity: 0.5; }

    .action-btn {
      width: 48px; height: 48px; border-radius: 14px; border: none;
      background: var(--accent); color: #fff; cursor: pointer;
      display: flex; align-items: center; justify-content: center; font-size: 20px;
      transition: all 0.2s; box-shadow: 0 4px 15px var(--accent-glow);
    }
    .action-btn:hover { transform: scale(1.05); filter: brightness(1.1); }
    body.premium .action-btn { color: #000; }
    
    .action-btn.locked { background: #333; color: #666; cursor: not-allowed; box-shadow: none; }

    .suggestions { display: flex; justify-content: center; flex-wrap: wrap; gap: 8px; margin-top: 20px; }
    .chip {
      font-size: 13px; padding: 8px 16px; background: rgba(255,255,255,0.03);
      border: 1px solid var(--border); border-radius: 99px; color: var(--text-muted);
      cursor: pointer; transition: all 0.2s; display: flex; align-items: center; gap: 6px;
    }
    .chip:hover {
      background: rgba(255,255,255,0.08); border-color: rgba(255,255,255,0.15);
      color: #fff; transform: translateY(-2px); box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    /* ERROR MSG */
    .error-msg {
      margin-top: 24px; padding: 12px 16px; 
      background: rgba(239, 68, 68, 0.1); border: 1px solid rgba(239, 68, 68, 0.3);
      color: #fca5a5; font-size: 13px; border-radius: 12px; text-align: left;
      display: flex; align-items: center; gap: 12px;
      max-width: 600px; margin-left: auto; margin-right: auto;
    }
    .error-msg a { color: #fff; font-weight: 600; }

    /* --- PROJECTS GRID --- */
    .section-header {
      display: flex; align-items: center; gap: 12px; margin-bottom: 24px;
      border-bottom: 1px solid var(--border); padding-bottom: 12px;
    }
    .section-header h2 { font-size: 16px; font-weight: 500; color: #fff; margin: 0; text-transform: uppercase; letter-spacing: 1px; }

    .project-limit-badge {
      font-size: 11px; padding: 4px 8px; border-radius: 4px; 
      background: rgba(255,255,255,0.05); color: var(--text-muted);
      border: 1px solid var(--border);
    }
    .project-limit-badge.limit-reached { color: #fca5a5; border-color: rgba(239,68,68,0.3); background: rgba(239,68,68,0.1); }

    .grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 24px; }

    .card {
      background: var(--panel); border: 1px solid var(--border); border-radius: 16px;
      padding: 24px; position: relative; cursor: pointer; transition: all 0.3s var(--ease-out);
      overflow: hidden; display: flex; flex-direction: column; height: 180px;
    }
    .card:hover {
      border-color: var(--border-hover); transform: translateY(-6px);
      box-shadow: 0 20px 40px -10px rgba(0,0,0,0.6);
      background: linear-gradient(to bottom, #16161a, var(--panel));
    }
    .card::before {
      content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 2px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
      opacity: 0; transition: opacity 0.3s;
    }
    .card:hover::before { opacity: 1; }

    .card-icon {
      width: 40px; height: 40px; background: rgba(255,255,255,0.03); border-radius: 10px;
      display: flex; align-items: center; justify-content: center; margin-bottom: 16px;
      color: var(--text-muted); font-size: 20px; transition: color 0.3s;
    }
    .card:hover .card-icon { color: var(--accent); background: rgba(59, 108, 255, 0.1); }
    body.premium .card:hover .card-icon { background: rgba(255, 215, 0, 0.1); }

    .card h3 { margin: 0 0 8px; font-size: 18px; font-weight: 500; color: #fff; }
    .card p { font-size: 14px; color: var(--text-muted); margin: 0; flex: 1; line-height: 1.4; overflow: hidden; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; }

    .card-footer {
      margin-top: 16px; display: flex; justify-content: space-between; align-items: center;
      font-size: 11px; color: #555; text-transform: uppercase; letter-spacing: 0.5px;
    }

    .card-actions { display: flex; align-items: center; gap: 8px; }
    .btn-icon { text-decoration: none; color: var(--text-muted); display: flex; align-items: center; gap: 4px; transition: color 0.2s; }
    .btn-icon:hover { color: #fff; }

    .btn-xmode {
      text-decoration: none; display: flex; align-items: center; gap: 6px;
      padding: 6px 12px; border-radius: 99px; background: rgba(255, 215, 0, 0.1); 
      border: 1px solid rgba(255, 215, 0, 0.3); color: #ffd700; font-size: 11px; font-weight: 700;
      transition: all 0.2s; z-index: 5;
    }
    .btn-xmode:hover { background: #ffd700; color: #000; box-shadow: 0 0 15px rgba(255, 215, 0, 0.4); transform: translateY(-1px); }

    .empty-state {
      grid-column: 1 / -1; padding: 80px 20px; text-align: center;
      border: 1px dashed var(--border); border-radius: 16px;
      color: var(--text-muted); background: rgba(255,255,255,0.01);
    }
    .empty-state i { font-size: 40px; margin-bottom: 16px; opacity: 0.3; display: block; }

    /* AD */
    .ad-container {
      margin-bottom: 60px; background: #000; border: 1px solid #222;
      border-radius: 16px; padding: 24px; display: flex; flex-direction: column; align-items: center; gap: 16px; position: relative;
    }
    .ad-badge {
      position: absolute; top: 12px; right: 12px; font-size: 9px; text-transform: uppercase;
      color: #444; border: 1px solid #333; padding: 2px 6px; border-radius: 4px;
    }
    .remove-ads-link {
      font-size: 11px; color: #666; text-decoration: none; 
      border-bottom: 1px dotted #666; transition: color 0.2s;
    }
    .remove-ads-link:hover { color: var(--accent); border-color: var(--accent); }

    /* --- AGENT SKILLS POPUP --- */
    .skills-modal-overlay {
      position: fixed; inset: 0; background: rgba(0, 0, 0, 0.8); backdrop-filter: blur(10px);
      display: none; align-items: center; justify-content: center; z-index: 9999;
      opacity: 0; transition: opacity 0.3s;
    }
    .skills-modal-overlay.active { display: flex; opacity: 1; }

    .skills-modal {
      background: #0f0f13; border: 1px solid var(--border); border-radius: 20px;
      width: 480px; max-width: 90vw; padding: 40px; text-align: center;
      box-shadow: 0 20px 60px rgba(0,0,0,0.8), 0 0 0 1px var(--accent-glow);
      transform: translateY(20px) scale(0.95); transition: all 0.3s var(--ease-out);
    }
    .skills-modal-overlay.active .skills-modal { transform: translateY(0) scale(1); }

    .skills-modal-icon {
      width: 64px; height: 64px; background: rgba(59, 108, 255, 0.1);
      border-radius: 16px; color: var(--accent); font-size: 32px;
      display: flex; align-items: center; justify-content: center;
      margin: 0 auto 20px auto; border: 1px solid var(--accent-glow);
    }

    .skills-modal h2 { font-size: 24px; color: #fff; margin: 0 0 12px; font-weight: 500; }
    .skills-modal p { color: var(--text-muted); font-size: 15px; line-height: 1.5; margin: 0 0 30px; }

    .skills-modal-actions { display: flex; gap: 12px; }
    
    .btn-modal-primary {
      flex: 1; background: var(--accent); color: #fff; border: none; padding: 12px;
      border-radius: 12px; font-size: 14px; font-weight: 600; cursor: pointer;
      text-decoration: none; transition: 0.2s;
    }
    .btn-modal-primary:hover { filter: brightness(1.1); transform: translateY(-1px); }
    
    .btn-modal-secondary {
      flex: 1; background: transparent; color: var(--text-muted); border: 1px solid var(--border);
      padding: 12px; border-radius: 12px; font-size: 14px; cursor: pointer; transition: 0.2s;
    }
    .btn-modal-secondary:hover { background: rgba(255,255,255,0.05); color: #fff; }
  </style>
</head>

<body class="{% if user.plan == 'premium' %}premium{% endif %}">

  <div class="noise-overlay"></div>
  <div class="glow-spot"></div>

  <aside>
    <div class="logo">
    <svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="800" height="803" viewBox="0 0 600 550" preserveAspectRatio="xMidYMid meet"> <g transform="translate(0.000000,603.000000) scale(0.100000,-0.100000)" fill="#ffffff" stroke="none"> <path d="M1497 6023 c827 -2 2179 -2 3005 0 827 1 151 2 -1502 2 -1653 0 -2329 -1 -1503 -2z"/> <path d="M2802 5273 c-43 -24 -131 -143 -182 -246 -99 -202 -106 -410 -19 -598 59 -128 153 -189 246 -158 56 18 81 37 108 84 34 57 32 112 -6 216 -54 145 -51 327 7 490 41 113 27 176 -46 214 -38 20 -68 19 -108 -2z"/> <path d="M3290 5268 c-74 -50 -185 -230 -228 -369 -44 -142 -37 -293 19 -440 52 -134 141 -208 234 -195 131 20 194 151 136 281 -67 150 -67 316 0 522 26 80 29 98 20 126 -28 83 -116 119 -181 75z"/> <path d="M685 4560 c-171 -34 -283 -139 -331 -306 -15 -50 -18 -129 -23 -519 -4 -321 -10 -466 -18 -480 -32 -56 -64 -70 -205 -90 -26 -4 -46 -17 -72 -45 -33 -36 -36 -45 -36 -99 0 -98 62 -161 157 -161 59 0 119 -26 146 -64 22 -31 22 -35 28 -496 5 -424 8 -471 26 -531 11 -37 31 -87 46 -111 72 -124 228 -198 418 -198 125 0 200 111 151 223 -26 59 -64 82 -148 90 -73 7 -116 27 -148 70 -20 28 -21 41 -27 490 -6 505 -8 526 -68 632 l-28 50 28 50 c60 106 62 128 68 630 6 427 7 462 25 491 26 44 68 65 139 71 81 7 131 35 157 88 26 53 25 91 -2 145 -32 61 -73 80 -168 79 -41 -1 -93 -5 -115 -9z"/> <path d="M5102 4550 c-68 -42 -92 -135 -54 -209 26 -52 60 -72 140 -81 83 -9 128 -32 157 -80 19 -33 20 -56 26 -500 6 -505 6 -513 66 -621 l26 -45 -26 -45 c-59 -103 -61 -113 -67 -619 -5 -461 -5 -465 -28 -501 -28 -45 -72 -67 -156 -77 -111 -14 -160 -66 -153 -165 4 -66 26 -103 78 -130 28 -15 50 -18 124 -13 218 12 351 101 416 278 22 61 23 74 28 533 6 503 6 500 58 547 19 18 78 34 155 43 33 4 56 15 78 35 29 27 30 31 30 118 0 88 -1 91 -31 116 -33 28 -45 32 -127 40 -66 7 -110 31 -137 76 -19 33 -20 56 -26 505 -6 496 -6 500 -55 598 -70 138 -221 217 -414 217 -57 0 -83 -5 -108 -20z"/> <path d="M1965 3849 c-113 -9 -166 -24 -280 -79 -312 -150 -493 -462 -471 -810 13 -209 89 -379 238 -529 161 -163 321 -236 545 -248 269 -14 478 70 667 267 61 65 95 111 130 179 70 136 89 217 89 386 0 124 -3 151 -27 230 -53 176 -145 314 -282 425 -174 139 -372 197 -609 179z m214 -324 c173 -46 319 -185 372 -354 23 -76 28 -212 9 -282 -50 -186 -208 -340 -391 -384 -181 -42 -372 15 -499 152 -100 106 -144 218 -143 363 1 290 228 517 518 519 44 0 104 -6 134 -14z"/> <path d="M3880 3849 c-190 -17 -341 -86 -488 -224 -112 -104 -200 -249 -239 -395 -25 -92 -25 -339 0 -430 78 -281 316 -519 597 -597 101 -28 339 -25 443 5 152 44 285 128 397 250 146 158 211 332 212 557 0 244 -82 436 -259 606 -181 175 -402 251 -663 228z m213 -324 c282 -73 454 -362 382 -640 -45 -171 -179 -312 -355 -371 -80 -27 -243 -25 -324 5 -202 73 -337 252 -353 466 -17 243 150 475 388 539 71 19 191 20 262 1z"/> </g> </svg>
      Gor://a
      <span class="premium-badge">PRO</span>
    </div>

    <nav>
      <a href="/dashboard" class="active">
        <i class="ph ph-squares-four"></i> Projects
      </a>
      
      <a href="/settings/skills" id="nav-agent-skills">
        <i class="ph ph-brain"></i> Agent Skills
      </a>

      <a href="/settings">
        <i class="ph ph-gear"></i> Settings
      </a>

      <a href="/pricing">
        <i class="ph ph-lightning"></i> Upgrade
      </a>
      <a href="/docs/intro">
        <i class="ph ph-book"></i> Docs
      </a>
    </nav>

    <div class="profile-container">
      <div class="profile-menu">
        <a href="/pricing" class="menu-item"><i class="ph ph-credit-card"></i> Billing</a>
        <a href="/auth/logout" class="menu-item logout"><i class="ph ph-sign-out"></i> Log Out</a>
      </div>

      <div class="user-profile">
        <div class="avatar">
          {{ user.email[0].upper() if user.email else 'U' }}
        </div>
        <div class="user-info">
          <span class="user-name">{% if user.email %}{{ user.email.split('@')[0] }}{% else %}User{% endif %}</span>
          <span class="user-plan">{{ user.plan|capitalize }} Plan</span>
        </div>
        <i class="ph ph-caret-up" style="margin-left:auto; opacity:0.5; font-size:12px;"></i>
      </div>
    </div>
  </aside>

  <main>
    
    <div class="header-row animate-entry" style="animation-delay: 0ms;">
      <div class="greeting">
        <h1>ðŸ‘‹ Hello, {% if user.email %}{{ user.email.split('@')[0] }}{% else %}User{% endif %} </h1>
        <p>Ready to build something amazing today?</p>
      </div>

      <div class="stats-group" style="display:flex; gap:16px; align-items:center;">
        <div class="token-widget">
          <div class="token-icon"><i class="ph-fill ph-coin"></i></div>
          <div class="token-text">
            <span class="token-val">{{ "{:,}".format(user.tokens.remaining) }}</span>
            <span class="token-lbl">Credits</span>
          </div>
        </div>
        
        {% if user.plan != 'premium' %}
          <a href="/pricing" class="upgrade-btn">Get Pro</a>
        {% else %}
          <a href="/checkout/tokens" class="upgrade-btn" style="background:#111; color:#fff; border:1px solid #333;">Top Up</a>
        {% endif %}
      </div>
    </div>

    <section class="builder-section animate-entry" style="animation-delay: 100ms;">
      {% set is_locked = (user.plan != 'premium' and projects|length >= 3) %}

      <form class="input-box {% if is_locked %}disabled{% endif %}" method="POST" action="/projects/create">
        
        {% if is_locked %}
          <input type="text" disabled placeholder="Free limit reached (3/3). Upgrade to create more." style="cursor:not-allowed;">
          <button type="button" class="action-btn locked" onclick="window.location.href='/pricing'">
            <i class="ph-fill ph-lock-key"></i>
          </button>
        {% else %}
          <input type="text" name="prompt" required placeholder="Describe your app idea (e.g. 'A kanban board for tracking tasks')" autocomplete="off" autofocus>
          <button type="submit" class="action-btn" title="Create App">
            <i class="ph-bold ph-arrow-right"></i>
          </button>
        {% endif %}
      </form>

      {% if not is_locked %}
      <div class="suggestions" id="ideas">
        <div class="chip"><i class="ph ph-storefront"></i> E-commerce Store</div>
        <div class="chip"><i class="ph ph-chart-bar"></i> Analytics Dashboard</div>
        <div class="chip"><i class="ph ph-robot"></i> AI Chat Bot</div>
        <div class="chip"><i class="ph ph-article"></i> Blog Platform</div>
      </div>
      {% endif %}

      {% if error %}
      <div class="error-msg">
          <i class="ph-fill ph-warning-circle" style="font-size:18px; color:#ef4444;"></i>
          <div style="flex:1;">
            <strong>{{ error }}</strong>
            {% if "Free Limit" in error %}
             <br><a href="/pricing" style="font-size:12px; opacity:0.8;">Upgrade now for unlimited access &rarr;</a>
            {% endif %}
          </div>
      </div>
      {% endif %}
    </section>

    {% if user.plan != 'premium' %}
    <div class="ad-container animate-entry" style="animation-delay: 200ms;">
      <span class="ad-badge">Ad</span>
      <ins class="adsbygoogle"
           style="display:inline-block;width:728px;height:90px"
           data-ad-client="ca-pub-1594181130407895"
           data-ad-slot="1944431541"></ins>
      <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
      <a href="/pricing" class="remove-ads-link">Remove Ads with Pro</a>
    </div>
    {% endif %}

    <div class="section-header animate-entry" style="animation-delay: 300ms;">
      <h2>Recent Projects</h2>
      
      {% if user.plan == 'premium' %}
        <span class="project-limit-badge">âˆž Projects</span>
      {% else %}
        <span class="project-limit-badge {% if projects|length >= 3 %}limit-reached{% endif %}">
          {{ projects|length }}/3 Projects
        </span>
      {% endif %}
    </div>

    <div class="grid animate-entry" style="animation-delay: 400ms;">
      {% for project in projects %}
        <div class="card" onclick="location.href='/projects/{{ project.id }}/editor'">
          
          <div class="card-icon">
            <i class="ph ph-code"></i>
          </div>
          
          <h3>{{ project.name }}</h3>
          <p>{{ project.description[:80] if project.description else 'No description provided.' }}...</p>
          
          <div class="card-footer">
            <span><i class="ph ph-clock"></i> {{ project.updated_at.split('T')[0] }}</span>
            
            <div class="card-actions">
              {% if user.plan == 'premium' %}
                <a href="/projects/{{ project.id }}/xmode" class="btn-xmode" onclick="event.stopPropagation();">
                  <i class="ph-fill ph-lightning"></i> X-MODE
                </a>
              {% endif %}
              
              <a href="/projects/{{ project.id }}/editor" class="btn-icon">
                Open <i class="ph-bold ph-arrow-right"></i>
              </a>
            </div>
          </div>
        </div>
      {% else %}
        <div class="empty-state">
          <i class="ph ph-ghost"></i>
          <p>It's quiet here. Start your first project above!</p>
        </div>
      {% endfor %}
    </div>

    {% if user.plan != 'premium' %}
    <div style="margin-top: 80px; display:flex; justify-content:center; gap:20px; flex-wrap:wrap; opacity:0.5;">
        <div style="width:300px; height:250px; background:#000; border-radius:12px; overflow:hidden; border:1px solid #222;">
           <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-1594181130407895" data-ad-slot="1944431541"></ins>
           <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>
        <div style="width:300px; height:250px; background:#000; border-radius:12px; overflow:hidden; border:1px solid #222;">
           <ins class="adsbygoogle" style="display:inline-block;width:300px;height:250px" data-ad-client="ca-pub-1594181130407895" data-ad-slot="1944431541"></ins>
           <script>(adsbygoogle = window.adsbygoogle || []).push({});</script>
        </div>
    </div>
    {% endif %}

  </main>

  <div class="skills-modal-overlay" id="skillsModal">
    <div class="skills-modal">
      <div class="skills-modal-icon">
        <i class="ph-bold ph-brain"></i>
      </div>
      <h2>Teach Your Agent</h2>
      <p>Configure your default design frameworks, visual styles, and coding preferences so Gor://a builds exactly the way you like.</p>
      
      <div class="skills-modal-actions">
        <button class="btn-modal-secondary" onclick="dismissSkillsModal()">Maybe Later</button>
        <a href="/settings/skills" class="btn-modal-primary">Setup Skills Now</a>
      </div>
    </div>
  </div>

  <script>
    // --- Ideas Chip Logic ---
    const ideas = document.getElementById("ideas");
    const input = document.querySelector("input[name='prompt']");
    if (ideas && input && !input.disabled) {
      ideas.addEventListener("click", (e) => {
        const chip = e.target.closest(".chip");
        if (!chip) return;
        const text = chip.textContent.trim();
        input.value = text;
        input.focus();
      });
    }

    // --- Agent Skills Popup Logic ---
    // Inject the variable from backend. If it's a string/None, we convert it to boolean.
    // NOTE: You must pass `has_skills: bool` from your dashboard route in app.py
    const hasSkillsStr = "{{ 'true' if has_skills else 'false' }}";
    const hasSkills = hasSkillsStr === "true";
    const skillsModal = document.getElementById('skillsModal');
    // Check if they dismissed it locally or if they already set it up
    if (!hasSkills && localStorage.getItem('hideSkillsModal') !== 'true') {
      // Small delay so it animates in smoothly after page load
      setTimeout(() => {
        skillsModal.classList.add('active');
      }, 800);
    }

    function dismissSkillsModal() {
      localStorage.setItem('hideSkillsModal', 'true');
      skillsModal.classList.remove('active');
    }
  </script>

</body>
</html>